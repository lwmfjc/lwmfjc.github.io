<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="sql常见面试题总结01">
<meta property="og:type" content="article">
<meta property="og:title" content="sql常见面试题总结01">
<meta property="og:url" content="http://example.com/2023/03/12/review/java_guide/database/ly0503lysql-question-01/index.html">
<meta property="og:site_name" content="随记">
<meta property="og:description" content="sql常见面试题总结01">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-03-12T17:53:18.000Z">
<meta property="article:modified_time" content="2023-03-12T17:53:18.000Z">
<meta property="article:author" content="刘易">
<meta property="article:tag" content="复习">
<meta property="article:tag" content="复习-javaGuide">
<meta property="article:tag" content="复习-javaGuide-database">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2023/03/12/review/java_guide/database/ly0503lysql-question-01/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>sql常见面试题总结01 | 随记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">随记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/12/review/java_guide/database/ly0503lysql-question-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/lwmfjc/lwmfjc.github.io.resource/main/img/avatar.png">
      <meta itemprop="name" content="刘易">
      <meta itemprop="description" content="知命不惧 日日自新">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          sql常见面试题总结01
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-12 17:53:18" itemprop="dateCreated datePublished" datetime="2023-03-12T17:53:18+00:00">2023-03-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">学习</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>46 分钟</span>
            </span>
            <div class="post-description">sql常见面试题总结01</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>转载自https://github.com/Snailclimb/JavaGuide（添加小部分笔记）感谢作者!</p>
</blockquote>
<blockquote>
<p>题目来源于：<a
target="_blank" rel="noopener" href="https://www.nowcoder.com/exam/oj?page=1&amp;tab=SQL篇&amp;topicId=298">牛客题霸
- SQL 必知必会</a></p>
</blockquote>
<h2 id="检索数据">检索数据</h2>
<p><code>select</code> 用于从数据库中查询数据。</p>
<h3 id="从-customers-表中检索所有的-id">从 Customers 表中检索所有的
ID</h3>
<p>现有表 <code>Customers</code> 如下：</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
</tr>
<tr class="even">
<td>B</td>
</tr>
<tr class="odd">
<td>C</td>
</tr>
</tbody>
</table>
<p>编写 SQL 语句，从 <code>Customers</code> 表中检索所有的
<code>cust_id</code>。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_id</span><br><span class="line">from Customers;</span><br></pre></td></tr></table></figure>
<h3 id="检索并列出已订购产品的清单">检索并列出已订购产品的清单</h3>
<p>表 <code>OrderItems</code> 含有非空的列 <code>prod_id</code> 代表商品
id，包含了所有已订购的商品（有些已被订购多次）。</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
</tr>
<tr class="even">
<td>a2</td>
</tr>
<tr class="odd">
<td>a3</td>
</tr>
<tr class="even">
<td>a4</td>
</tr>
<tr class="odd">
<td>a5</td>
</tr>
<tr class="even">
<td>a6</td>
</tr>
<tr class="odd">
<td>a7</td>
</tr>
</tbody>
</table>
<p>编写 SQL
语句，检索并列出所有已订购商品（<code>prod_id</code>）的去重后的清单。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select distinct prod_id</span><br><span class="line">from OrderItems;</span><br></pre></td></tr></table></figure>
<p>知识点：<code>distinct</code> 用于返回列中的唯一不同值。</p>
<h3 id="检索所有列">检索所有列</h3>
<p>现在有 <code>Customers</code> 表（表中含有列 <code>cust_id</code>
代表客户 id，<code>cust_name</code> 代表客户姓名）</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>andy</td>
</tr>
<tr class="even">
<td>a2</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>tony</td>
</tr>
<tr class="even">
<td>a4</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>an</td>
</tr>
<tr class="even">
<td>a6</td>
<td>lee</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>hex</td>
</tr>
</tbody>
</table>
<p>需要编写 SQL 语句，检索所有列。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_id, cust_name</span><br><span class="line">from Customers;</span><br></pre></td></tr></table></figure>
<h2 id="排序检索数据">排序检索数据</h2>
<p><code>order by</code>
用于对结果集按照一个列或者多个列进行排序。默认按照升序对记录进行排序，如果需要按照降序对记录进行排序，可以使用
<code>desc</code> 关键字。</p>
<h3 id="检索顾客名称并且排序">检索顾客名称并且排序</h3>
<p>有表 <code>Customers</code>，<code>cust_id</code> 代表客户
id，<code>cust_name</code> 代表客户姓名。</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>andy</td>
</tr>
<tr class="even">
<td>a2</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>tony</td>
</tr>
<tr class="even">
<td>a4</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>an</td>
</tr>
<tr class="even">
<td>a6</td>
<td>lee</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>hex</td>
</tr>
</tbody>
</table>
<p>从 <code>Customers</code>
中检索所有的顾客名称（<code>cust_name</code>），并按从 Z 到 A
的顺序显示结果。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_name from Customers order by cust_name desc</span><br></pre></td></tr></table></figure>
<h3 id="对顾客-id-和日期排序">对顾客 ID 和日期排序</h3>
<p>有 <code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>order_num</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>andy</td>
<td>aaaa</td>
<td>2021-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>andy</td>
<td>bbbb</td>
<td>2021-01-01 12:00:00</td>
</tr>
<tr class="odd">
<td>bob</td>
<td>cccc</td>
<td>2021-01-10 12:00:00</td>
</tr>
<tr class="even">
<td>dick</td>
<td>dddd</td>
<td>2021-01-11 00:00:00</td>
</tr>
</tbody>
</table>
<p>编写 SQL 语句，从 <code>Orders</code> 表中检索顾客
ID（<code>cust_id</code>）和订单号（<code>order_num</code>），并先按顾客
ID 对结果进行排序，再按订单日期倒序排列。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 根据列名排序</span><br><span class="line"># 注意：是 order_date 降序，而不是 order_num</span><br><span class="line">select cust_id, order_num</span><br><span class="line">from Orders</span><br><span class="line">order by cust_id, order_date desc;</span><br></pre></td></tr></table></figure>
<p>知识点：<code>order by</code>
对多列排序的时候，先排序的列放前面，后排序的列放后面。并且，不同的列可以有不同的排序规则。</p>
<h3 id="按照数量和价格排序">按照数量和价格排序</h3>
<p>假设有一个 <code>OrderItems</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>quantity</th>
<th>item_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>100</td>
</tr>
<tr class="even">
<td>10</td>
<td>1003</td>
</tr>
<tr class="odd">
<td>2</td>
<td>500</td>
</tr>
</tbody>
</table>
<p>编写 SQL 语句，显示 <code>OrderItems</code>
表中的数量（<code>quantity</code>）和价格（<code>item_price</code>），并按数量由多到少、价格由高到低排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select quantity, item_price</span><br><span class="line">from OrderItems</span><br><span class="line">order by quantity desc, item_price desc;</span><br></pre></td></tr></table></figure>
<h3 id="检查-sql-语句">检查 SQL 语句</h3>
<p>有 <code>Vendors</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>vend_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>海底捞</td>
</tr>
<tr class="even">
<td>小龙坎</td>
</tr>
<tr class="odd">
<td>大龙燚</td>
</tr>
</tbody>
</table>
<p>下面的 SQL
语句有问题吗？尝试将它改正确，使之能够正确运行，并且返回结果根据<code>vend_name</code>
逆序排列。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT vend_name,</span><br><span class="line">FROM Vendors</span><br><span class="line">ORDER vend_name DESC;</span><br></pre></td></tr></table></figure>
<p>改正后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_name</span><br><span class="line">from Vendors</span><br><span class="line">order by vend_name desc;</span><br></pre></td></tr></table></figure>
<p>知识点：</p>
<ul>
<li>逗号作用是用来隔开列与列之间的。</li>
<li>order by 是有 by 的，需要撰写完整，且位置正确。</li>
</ul>
<h2 id="过滤数据">过滤数据</h2>
<p><code>where</code> 可以过滤返回的数据。</p>
<p>下面的运算符可以在 <code>where</code> 子句中使用：</p>
<table>
<thead>
<tr class="header">
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>=</td>
<td>等于</td>
</tr>
<tr class="even">
<td>&lt;&gt;</td>
<td>不等于。<strong>注释：</strong>在 SQL 的一些版本中，该操作符可被写成
!=</td>
</tr>
<tr class="odd">
<td>&gt;</td>
<td>大于</td>
</tr>
<tr class="even">
<td>&lt;</td>
<td>小于</td>
</tr>
<tr class="odd">
<td>&gt;=</td>
<td>大于等于</td>
</tr>
<tr class="even">
<td>&lt;=</td>
<td>小于等于</td>
</tr>
<tr class="odd">
<td>BETWEEN</td>
<td>在某个范围内</td>
</tr>
<tr class="even">
<td>LIKE</td>
<td>搜索某种模式</td>
</tr>
<tr class="odd">
<td>IN</td>
<td>指定针对某个列的多个可能值</td>
</tr>
</tbody>
</table>
<h3 id="返回固定价格的产品">返回固定价格的产品</h3>
<p>有表 <code>Products</code> ：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0018</td>
<td>sockets</td>
<td>9.49</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
<td>600</td>
</tr>
<tr class="odd">
<td>b0018</td>
<td>gucci t-shirts</td>
<td>1000</td>
</tr>
</tbody>
</table>
<p>【问题】从 <code>Products</code> 表中检索产品
ID（<code>prod_id</code>）和产品名称（<code>prod_name</code>），只返回价格为
9.49 美元的产品。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_id, prod_name</span><br><span class="line">from Products</span><br><span class="line">where prod_price = 9.49;</span><br></pre></td></tr></table></figure>
<h3 id="返回更高价格的产品">返回更高价格的产品</h3>
<p>有表 <code>Products</code> ：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0018</td>
<td>sockets</td>
<td>9.49</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
<td>600</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>gucci t-shirts</td>
<td>1000</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Products</code> 表中检索产品
ID（<code>prod_id</code>）和产品名称（<code>prod_name</code>），只返回价格为
9 美元或更高的产品。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_id, prod_name</span><br><span class="line">from Products</span><br><span class="line">where prod_price &gt;= 9;</span><br></pre></td></tr></table></figure>
<h3 id="返回产品并且按照价格排序">返回产品并且按照价格排序</h3>
<p>有表 <code>Products</code> ：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>egg</td>
<td>3</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>sockets</td>
<td>4</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>coffee</td>
<td>15</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回 <code>Products</code> 表中所有价格在 3
美元到 6
美元之间的产品的名称（<code>prod_name</code>）和价格（<code>prod_price</code>），然后按价格对结果进行排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_price</span><br><span class="line">from Products</span><br><span class="line">where prod_price between 3 and 6</span><br><span class="line">order by prod_price;</span><br><span class="line"></span><br><span class="line"># 或者</span><br><span class="line">select prod_name, prod_price</span><br><span class="line">from Products</span><br><span class="line">where prod_price &gt;= 3 and prod_price &lt;= 6</span><br><span class="line">order by prod_price;</span><br></pre></td></tr></table></figure>
<h3 id="返回更多的产品">返回更多的产品</h3>
<p><code>OrderItems</code> 表含有：订单号
<code>order_num</code>，<code>quantity</code>产品数量</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>105</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>200</td>
</tr>
<tr class="even">
<td>a4</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>【问题】从 <code>OrderItems</code>
表中检索出所有不同且不重复的订单号（<code>order_num</code>），其中每个订单都要包含
100 个或更多的产品。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select distinct order_num</span><br><span class="line">from OrderItems</span><br><span class="line">where quantity &gt;= 100;</span><br></pre></td></tr></table></figure>
<h2 id="高级数据过滤">高级数据过滤</h2>
<p><code>and</code> 和 <code>or</code>
运算符用于基于一个以上的条件对记录进行过滤，两者可以结合使用。<code>and</code>
必须 2 个条件都成立，<code>or</code>只要 2 个条件中的一个成立即可。</p>
<h3 id="检索供应商名称">检索供应商名称</h3>
<p><code>Vendors</code>
表有字段供应商名称（<code>vend_name</code>）、供应商国家（<code>vend_country</code>）、供应商州（<code>vend_state</code>）</p>
<table>
<thead>
<tr class="header">
<th>vend_name</th>
<th>vend_country</th>
<th>vend_state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>apple</td>
<td>USA</td>
<td>CA</td>
</tr>
<tr class="even">
<td>vivo</td>
<td>CNA</td>
<td>shenzhen</td>
</tr>
<tr class="odd">
<td>huawei</td>
<td>CNA</td>
<td>xian</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Vendors</code>
表中检索供应商名称（<code>vend_name</code>），仅返回加利福尼亚州的供应商（这需要按国家[USA]和州[CA]进行过滤，没准其他国家也存在一个
CA）</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_name</span><br><span class="line">from Vendors</span><br><span class="line">where vend_country = &#x27;USA&#x27; and vend_state = &#x27;CA&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="检索并列出已订购产品的清单-1">检索并列出已订购产品的清单</h3>
<p><code>OrderItems</code>
表包含了所有已订购的产品（有些已被订购多次）。</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BR01</td>
<td>a1</td>
<td>105</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a2</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>BR02</td>
<td>a2</td>
<td>200</td>
</tr>
<tr class="even">
<td>BR03</td>
<td>a4</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>BR017</td>
<td>a5</td>
<td>10</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a2</td>
<td>19</td>
</tr>
<tr class="odd">
<td>BR017</td>
<td>a7</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，查找所有订购了数量至少 100 个的
<code>BR01</code>、<code>BR02</code> 或 <code>BR03</code>
的订单。你需要返回 <code>OrderItems</code>
表的订单号（<code>order_num</code>）、产品
ID（<code>prod_id</code>）和数量（<code>quantity</code>），并按产品 ID
和数量进行过滤。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select order_num, prod_id, quantity</span><br><span class="line">from OrderItems</span><br><span class="line">where quantity &gt;= 100</span><br><span class="line">    and prod_id in(&#x27;BR01&#x27;, &#x27;BR02&#x27;, &#x27;BR03&#x27;);</span><br></pre></td></tr></table></figure>
<h3
id="返回所有价格在-3-美元到-6-美元之间的产品的名称和价格">返回所有价格在
3 美元到 6 美元之间的产品的名称和价格</h3>
<p>有表 <code>Products</code>：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>egg</td>
<td>3</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>sockets</td>
<td>4</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>coffee</td>
<td>15</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回所有价格在 3 美元到 6
美元之间的产品的名称（<code>prod_name</code>）和价格（<code>prod_price</code>），使用
AND 操作符，然后按价格对结果进行升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_price</span><br><span class="line">from Products</span><br><span class="line">where prod_price between 3 and 6</span><br><span class="line">order by prod_price;</span><br></pre></td></tr></table></figure>
<h3 id="检查-sql-语句-1">检查 SQL 语句</h3>
<p>供应商表 <code>Vendors</code> 有字段供应商名称
<code>vend_name</code>、供应商国家 <code>vend_country</code>、供应商省份
<code>vend_state</code></p>
<table>
<thead>
<tr class="header">
<th>vend_name</th>
<th>vend_country</th>
<th>vend_state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>apple</td>
<td>USA</td>
<td>CA</td>
</tr>
<tr class="even">
<td>vivo</td>
<td>CNA</td>
<td>shenzhen</td>
</tr>
<tr class="odd">
<td>huawei</td>
<td>CNA</td>
<td>xian</td>
</tr>
</tbody>
</table>
<p>【问题】修改正确下面 sql，使之正确返回。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT vend_name</span><br><span class="line">FROM Vendors</span><br><span class="line">ORDER BY vend_name</span><br><span class="line">WHERE vend_country = &#x27;USA&#x27; AND vend_state = &#x27;CA&#x27;;</span><br></pre></td></tr></table></figure>
<p>修改后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_name</span><br><span class="line">from Vendors</span><br><span class="line">where vend_country = &#x27;USA&#x27; and vend_state = &#x27;CA&#x27;</span><br><span class="line">order by vend_name;</span><br></pre></td></tr></table></figure>
<p><strong><code>order by</code> 语句必须放在 where 之后。</strong></p>
<h2 id="用通配符进行过滤">用通配符进行过滤</h2>
<p>SQL 通配符必须与 <code>LIKE</code> 运算符一起使用</p>
<p>在 SQL 中，可使用以下通配符：</p>
<table>
<thead>
<tr class="header">
<th>通配符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%</code></td>
<td>代表零个或多个字符</td>
</tr>
<tr class="even">
<td><code>_</code></td>
<td>仅替代一个字符</td>
</tr>
<tr class="odd">
<td><code>[charlist]</code></td>
<td>字符列中的任何单一字符</td>
</tr>
<tr class="even">
<td><code>[^charlist]</code> 或者 <code>[!charlist]</code></td>
<td>不在字符列中的任何单一字符</td>
</tr>
</tbody>
</table>
<h3 id="检索产品名称和描述一">检索产品名称和描述（一）</h3>
<p><code>Products</code> 表如下：</p>
<table>
<thead>
<tr class="header">
<th>prod_name</th>
<th>prod_desc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>usb</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>gucci t-shirts</td>
</tr>
<tr class="even">
<td>c0019</td>
<td>gucci toy</td>
</tr>
<tr class="odd">
<td>d0019</td>
<td>lego toy</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Products</code>
表中检索产品名称（<code>prod_name</code>）和描述（<code>prod_desc</code>），仅返回描述中包含
<code>toy</code> 一词的产品名称。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_desc</span><br><span class="line">from Products</span><br><span class="line">where prod_desc like &#x27;%toy%&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="检索产品名称和描述二">检索产品名称和描述（二）</h3>
<p><code>Products</code> 表如下：</p>
<table>
<thead>
<tr class="header">
<th>prod_name</th>
<th>prod_desc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>usb</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>gucci t-shirts</td>
</tr>
<tr class="even">
<td>c0019</td>
<td>gucci toy</td>
</tr>
<tr class="odd">
<td>d0019</td>
<td>lego toy</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Products</code>
表中检索产品名称（<code>prod_name</code>）和描述（<code>prod_desc</code>），仅返回描述中未出现
<code>toy</code> 一词的产品，最后按”产品名称“对结果进行排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_desc</span><br><span class="line">from Products</span><br><span class="line">where prod_desc not like &#x27;%toy%&#x27;</span><br><span class="line">order by prod_name;</span><br></pre></td></tr></table></figure>
<h3 id="检索产品名称和描述三">检索产品名称和描述（三）</h3>
<p><code>Products</code> 表如下：</p>
<table>
<thead>
<tr class="header">
<th>prod_name</th>
<th>prod_desc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>usb</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>gucci t-shirts</td>
</tr>
<tr class="even">
<td>c0019</td>
<td>gucci toy</td>
</tr>
<tr class="odd">
<td>d0019</td>
<td>lego carrots toy</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Products</code>
表中检索产品名称（<code>prod_name</code>）和描述（<code>prod_desc</code>），仅返回描述中同时出现
<code>toy</code> 和 <code>carrots</code>
的产品。有好几种方法可以执行此操作，但对于这个挑战题，请使用
<code>AND</code> 和两个 <code>LIKE</code> 比较。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_desc</span><br><span class="line">from Products</span><br><span class="line">where prod_desc like &#x27;%toy%&#x27;</span><br><span class="line">    and prod_desc like &quot;%carrots%&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="检索产品名称和描述四">检索产品名称和描述（四）</h3>
<p><code>Products</code> 表如下：</p>
<table>
<thead>
<tr class="header">
<th>prod_name</th>
<th>prod_desc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>usb</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>iphone13</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>gucci t-shirts</td>
</tr>
<tr class="even">
<td>c0019</td>
<td>gucci toy</td>
</tr>
<tr class="odd">
<td>d0019</td>
<td>lego toy carrots</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 Products
表中检索产品名称（prod_name）和描述（prod_desc），仅返回在描述中以<strong>先后顺序</strong>同时出现
toy 和 carrots 的产品。提示：只需要用带有三个 <code>%</code> 符号的
<code>LIKE</code> 即可。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, prod_desc</span><br><span class="line">from Products</span><br><span class="line">where prod_desc like &#x27;%toy%carrots%&#x27;;</span><br></pre></td></tr></table></figure>
<h2 id="创建计算字段">创建计算字段</h2>
<h3 id="别名">别名</h3>
<p>别名的常见用法是在检索出的结果中重命名表的列字段（为了符合特定的报表要求或客户需求）。有表
<code>Vendors</code> 代表供应商信息，<code>vend_id</code> 供应商
id、<code>vend_name</code> 供应商名称、<code>vend_address</code>
供应商地址、<code>vend_city</code> 供应商城市。</p>
<table>
<thead>
<tr class="header">
<th>vend_id</th>
<th>vend_name</th>
<th>vend_address</th>
<th>vend_city</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a001</td>
<td>tencent cloud</td>
<td>address1</td>
<td>shenzhen</td>
</tr>
<tr class="even">
<td>a002</td>
<td>huawei cloud</td>
<td>address2</td>
<td>dongguan</td>
</tr>
<tr class="odd">
<td>a003</td>
<td>aliyun cloud</td>
<td>address3</td>
<td>hangzhou</td>
</tr>
<tr class="even">
<td>a003</td>
<td>netease cloud</td>
<td>address4</td>
<td>guangzhou</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，从 <code>Vendors</code> 表中检索
<code>vend_id</code>、<code>vend_name</code>、<code>vend_address</code>
和 <code>vend_city</code>，将 <code>vend_name</code> 重命名为
<code>vname</code>，将 <code>vend_city</code> 重命名为
<code>vcity</code>，将 <code>vend_address</code> 重命名为
<code>vaddress</code>，按供应商名称对结果进行升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_id, vend_name as vname, vend_address as vaddress, vend_city as vcity</span><br><span class="line">from Vendors</span><br><span class="line">order by vname;</span><br><span class="line"></span><br><span class="line"># as 可以省略</span><br><span class="line">select vend_id, vend_name vname, vend_address vaddress, vend_city vcity</span><br><span class="line">from Vendors</span><br><span class="line">order by vname;</span><br></pre></td></tr></table></figure>
<h3 id="打折">打折</h3>
<p>我们的示例商店正在进行打折促销，所有产品均降价
10%。<code>Products</code> 表包含 <code>prod_id</code> 产品
id、<code>prod_price</code> 产品价格。</p>
<p>【问题】编写 SQL 语句，从 <code>Products</code> 表中返回
<code>prod_id</code>、<code>prod_price</code> 和
<code>sale_price</code>。<code>sale_price</code>
是一个包含促销价格的计算字段。提示：可以乘以 0.9，得到原价的 90%（即
10%的折扣）。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_id, prod_price, prod_price * 0.9 as sale_price</span><br><span class="line">from Products;</span><br></pre></td></tr></table></figure>
<p>注意：<code>sale_price</code>
是对计算结果的命名，而不是原有的列名。</p>
<h2 id="使用函数处理数据">使用函数处理数据</h2>
<h3 id="顾客登录名">顾客登录名</h3>
<p>我们的商店已经上线了，正在创建顾客账户。所有用户都需要登录名，默认登录名是其名称和所在城市的组合。</p>
<p>给出 <code>Customers</code> 表 如下：</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
<th>cust_contact</th>
<th>cust_city</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>Andy Li</td>
<td>Andy Li</td>
<td>Oak Park</td>
</tr>
<tr class="even">
<td>a2</td>
<td>Ben Liu</td>
<td>Ben Liu</td>
<td>Oak Park</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>Tony Dai</td>
<td>Tony Dai</td>
<td>Oak Park</td>
</tr>
<tr class="even">
<td>a4</td>
<td>Tom Chen</td>
<td>Tom Chen</td>
<td>Oak Park</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>An Li</td>
<td>An Li</td>
<td>Oak Park</td>
</tr>
<tr class="even">
<td>a6</td>
<td>Lee Chen</td>
<td>Lee Chen</td>
<td>Oak Park</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>Hex Liu</td>
<td>Hex Liu</td>
<td>Oak Park</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回顾客
ID（<code>cust_id</code>）、顾客名称（<code>cust_name</code>）和登录名（<code>user_login</code>），其中登录名全部为大写字母，并由顾客联系人的前两个字符（<code>cust_contact</code>）和其所在城市的前三个字符（<code>cust_city</code>）组成。提示：需要使用函数、拼接和别名。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select</span><br><span class="line">    cust_id,</span><br><span class="line">    cust_name,</span><br><span class="line">    upper(concat(substring(cust_contact, 1, 2), substring(cust_city, 1, 3))) as user_login</span><br><span class="line">from</span><br><span class="line">    Customers;</span><br></pre></td></tr></table></figure>
<p>知识点：</p>
<ul>
<li><p>截取函数<code>substring()</code>：截取字符串，<code>substring(str ,n ,m)</code>：返回字符串
str 从第 n 个字符截取到第 m 个字符（左闭右闭）；</p>
<blockquote>
<p>返回字符串 str 从第 n 个字符截取 m 个字符（左闭右闭）</p>
</blockquote></li>
<li><p>拼接函数<code>concat()</code>：将两个或多个字符串连接成一个字符串，select
concat(A,B) ：连接字符串 A 和 B。</p></li>
<li><p>大写函数 <code>upper()</code>：将指定字符串转换为大写。</p></li>
</ul>
<h3 id="返回-2020-年-1-月的所有订单的订单号和订单日期">返回 2020 年 1
月的所有订单的订单号和订单日期</h3>
<p><code>Orders</code> 订单表如下：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>2020-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>2020-01-02 00:00:00</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>2020-01-01 12:00:00</td>
</tr>
<tr class="even">
<td>a0004</td>
<td>2020-02-01 00:00:00</td>
</tr>
<tr class="odd">
<td>a0005</td>
<td>2020-03-01 00:00:00</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回 2020 年 1
月的所有订单的订单号（<code>order_num</code>）和订单日期（<code>order_date</code>），并按订单日期升序排序</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select order_num, order_date</span><br><span class="line">from Orders</span><br><span class="line">where month(order_date) = &#x27;01&#x27; and year(order_date) = &#x27;2020&#x27;</span><br><span class="line">order by order_date;</span><br></pre></td></tr></table></figure>
<p>也可以用通配符来做：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select order_num, order_date</span><br><span class="line">from Orders</span><br><span class="line">where order_date like &#x27;2020-01%&#x27;</span><br><span class="line">order by order_date;</span><br></pre></td></tr></table></figure>
<p>知识点：</p>
<ul>
<li>日期格式：<code>YYYY-MM-DD</code></li>
<li>时间格式：<code>HH:MM:SS</code></li>
</ul>
<p>日期和时间处理相关的常用函数：</p>
<table>
<thead>
<tr class="header">
<th>函 数</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>adddate()</code></td>
<td>增加一个日期（天、周等）</td>
</tr>
<tr class="even">
<td><code>addtime()</code></td>
<td>增加一个时间（时、分等）</td>
</tr>
<tr class="odd">
<td><code>curdate()</code></td>
<td>返回当前日期</td>
</tr>
<tr class="even">
<td><code>curtime()</code></td>
<td>返回当前时间</td>
</tr>
<tr class="odd">
<td><code>date()</code></td>
<td>返回日期时间的日期部分</td>
</tr>
<tr class="even">
<td><code>datediff()</code></td>
<td>计算两个日期之差</td>
</tr>
<tr class="odd">
<td><code>date_format()</code></td>
<td>返回一个格式化的日期或时间串</td>
</tr>
<tr class="even">
<td><code>day()</code></td>
<td>返回一个日期的天数部分</td>
</tr>
<tr class="odd">
<td><code>dayofweek()</code></td>
<td>对于一个日期，返回对应的星期几</td>
</tr>
<tr class="even">
<td><code>hour()</code></td>
<td>返回一个时间的小时部分</td>
</tr>
<tr class="odd">
<td><code>minute()</code></td>
<td>返回一个时间的分钟部分</td>
</tr>
<tr class="even">
<td><code>month()</code></td>
<td>返回一个日期的月份部分</td>
</tr>
<tr class="odd">
<td><code>now()</code></td>
<td>返回当前日期和时间</td>
</tr>
<tr class="even">
<td><code>second()</code></td>
<td>返回一个时间的秒部分</td>
</tr>
<tr class="odd">
<td><code>time()</code></td>
<td>返回一个日期时间的时间部分</td>
</tr>
<tr class="even">
<td><code>year()</code></td>
<td>返回一个日期的年份部分</td>
</tr>
</tbody>
</table>
<h2 id="汇总数据">汇总数据</h2>
<p>汇总数据相关的函数：</p>
<table>
<thead>
<tr class="header">
<th>函 数</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>avg()</code></td>
<td>返回某列的平均值</td>
</tr>
<tr class="even">
<td><code>count()</code></td>
<td>返回某列的行数</td>
</tr>
<tr class="odd">
<td><code>max()</code></td>
<td>返回某列的最大值</td>
</tr>
<tr class="even">
<td><code>min()</code></td>
<td>返回某列的最小值</td>
</tr>
<tr class="odd">
<td><code>sum()</code></td>
<td>返回某列值之和</td>
</tr>
</tbody>
</table>
<h3 id="确定已售出产品的总数">确定已售出产品的总数</h3>
<p><code>OrderItems</code> 表代表售出的产品，<code>quantity</code>
代表售出商品数量。</p>
<table>
<thead>
<tr class="header">
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
</tr>
<tr class="even">
<td>100</td>
</tr>
<tr class="odd">
<td>1000</td>
</tr>
<tr class="even">
<td>10001</td>
</tr>
<tr class="odd">
<td>2</td>
</tr>
<tr class="even">
<td>15</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，确定已售出产品的总数。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select sum(quantity) as items_ordered</span><br><span class="line">from OrderItems;</span><br></pre></td></tr></table></figure>
<h3 id="确定已售出产品项-br01-的总数">确定已售出产品项 BR01 的总数</h3>
<p><code>OrderItems</code> 表代表售出的产品，<code>quantity</code>
代表售出商品数量，产品项为 <code>prod_id</code>。</p>
<table>
<thead>
<tr class="header">
<th>quantity</th>
<th>prod_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>AR01</td>
</tr>
<tr class="even">
<td>100</td>
<td>AR10</td>
</tr>
<tr class="odd">
<td>1000</td>
<td>BR01</td>
</tr>
<tr class="even">
<td>10001</td>
<td>BR010</td>
</tr>
</tbody>
</table>
<p>【问题】修改创建的语句，确定已售出产品项（<code>prod_id</code>）为"BR01"的总数。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select sum(quantity) as items_ordered</span><br><span class="line">from OrderItems</span><br><span class="line">where prod_id = &#x27;BR01&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="确定-products-表中价格不超过-10-美元的最贵产品的价格">确定
Products 表中价格不超过 10 美元的最贵产品的价格</h3>
<p><code>Products</code> 表如下，<code>prod_price</code>
代表商品的价格。</p>
<table>
<thead>
<tr class="header">
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>9.49</td>
</tr>
<tr class="even">
<td>600</td>
</tr>
<tr class="odd">
<td>1000</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，确定 <code>Products</code> 表中价格不超过 10
美元的最贵产品的价格（<code>prod_price</code>）。将计算所得的字段命名为
<code>max_price</code>。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select max(prod_price) as max_price</span><br><span class="line">from Products</span><br><span class="line">where prod_price &lt;= 10;</span><br></pre></td></tr></table></figure>
<h2 id="分组数据">分组数据</h2>
<p><code>group by</code> ：</p>
<ul>
<li><code>group by</code> 子句将记录分组到汇总行中。</li>
<li><code>group by</code> 为每个组返回一个记录。</li>
<li><code>group by</code>
通常还涉及聚合<code>count</code>，<code>max</code>，<code>sum</code>，<code>avg</code>
等。</li>
<li><code>group by</code> 可以按一列或多列进行分组。</li>
<li><code>group by</code> 按分组字段进行排序后，<code>order by</code>
可以以汇总字段来进行排序。</li>
</ul>
<p><code>having</code>：</p>
<ul>
<li><code>having</code> 用于对汇总的 <code>group by</code>
结果进行过滤。</li>
<li><code>having</code> 必须要与 <code>group by</code> 连用。</li>
<li><code>where</code> 和 <code>having</code> 可以在相同的查询中。</li>
</ul>
<p><code>having</code> vs <code>where</code>：</p>
<ul>
<li><code>where</code>：过滤过滤指定的行，后面不能加聚合函数（分组函数）。</li>
<li><code>having</code>：过滤分组，必须要与 <code>group by</code>
连用，不能单独使用。</li>
</ul>
<h3 id="返回每个订单号各有多少行数">返回每个订单号各有多少行数</h3>
<p><code>OrderItems</code> 表包含每个订单的每个产品</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a002</td>
</tr>
<tr class="even">
<td>a002</td>
</tr>
<tr class="odd">
<td>a002</td>
</tr>
<tr class="even">
<td>a004</td>
</tr>
<tr class="odd">
<td>a007</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL
语句，返回每个订单号（<code>order_num</code>）各有多少行数（<code>order_lines</code>），并按
<code>order_lines</code> 对结果进行升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select order_num, count(order_num) as order_lines</span><br><span class="line">from OrderItems</span><br><span class="line">group by order_num</span><br><span class="line">order by order_lines;</span><br></pre></td></tr></table></figure>
<p>知识点：</p>
<ol type="1">
<li><code>count(*)</code>,<code>count(列名)</code>都可以，区别在于，<strong><code>count(列名)</code>是统计非
NULL 的行数</strong>；</li>
<li><strong><code>order by</code>
最后执行，所以可以使用列别名</strong>；</li>
<li>分组聚合一定不要忘记加上 <code>group by</code>
,不然只会有一行结果。</li>
</ol>
<h3 id="每个供应商成本最低的产品">每个供应商成本最低的产品</h3>
<p>有 <code>Products</code> 表，含有字段 <code>prod_price</code>
代表产品价格，<code>vend_id</code> 代表供应商 id</p>
<table>
<thead>
<tr class="header">
<th>vend_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0011</td>
<td>100</td>
</tr>
<tr class="even">
<td>a0019</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>1000</td>
</tr>
<tr class="even">
<td>b0019</td>
<td>6980</td>
</tr>
<tr class="odd">
<td>b0019</td>
<td>20</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回名为 <code>cheapest_item</code>
的字段，该字段包含每个供应商成本最低的产品（使用 <code>Products</code>
表中的
<code>prod_price</code>），然后从最低成本到最高成本对结果进行升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_id, min(prod_price) as cheapest_item</span><br><span class="line">from Products</span><br><span class="line">group by vend_id</span><br><span class="line">order by cheapest_item;</span><br></pre></td></tr></table></figure>
<h3
id="返回订单数量总和不小于-100-的所有订单的订单号">返回订单数量总和不小于
100 的所有订单的订单号</h3>
<p><code>OrderItems</code> 代表订单商品表，包括：订单号
<code>order_num</code> 和订单数量 <code>quantity</code>。</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>105</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>200</td>
</tr>
<tr class="even">
<td>a4</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>【问题】请编写 SQL 语句，返回订单数量总和不小于 100
的所有订单号，最后结果按照订单号升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 直接聚合</span><br><span class="line">select order_num</span><br><span class="line">from OrderItems</span><br><span class="line">group by order_num</span><br><span class="line">having sum(quantity) &gt;= 100</span><br><span class="line">order by order_num;</span><br><span class="line"></span><br><span class="line"># 子查询</span><br><span class="line">select order_num</span><br><span class="line">from (select order_num, sum(quantity) as sum_num</span><br><span class="line">        from OrderItems group by order_num having sum_num &gt;= 100</span><br><span class="line">) a</span><br><span class="line">order by order_num;</span><br></pre></td></tr></table></figure>
<p>知识点：</p>
<ul>
<li><code>where</code>：过滤过滤指定的行，后面不能加聚合函数（分组函数）。</li>
<li><code>having</code>：过滤分组，与 <code>group by</code>
连用，不能单独使用。</li>
</ul>
<h3 id="计算总和">计算总和</h3>
<p><code>OrderItems</code> 表代表订单信息，包括字段：订单号
<code>order_num</code> 和 <code>item_price</code>
商品售出价格、<code>quantity</code> 商品数量。</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>item_price</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>10</td>
<td>105</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>1</td>
<td>200</td>
</tr>
<tr class="even">
<td>a4</td>
<td>2</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>5</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>7</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，根据订单号聚合，返回订单总价不小于 1000
的所有订单号，最后的结果按订单号进行升序排序。</p>
<p>提示：总价 = item_price 乘以 quantity</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select order_num, sum(item_price * quantity) as total_price</span><br><span class="line">from OrderItems</span><br><span class="line">group by order_num</span><br><span class="line">having total_price &gt;= 1000</span><br><span class="line">order by order_num;</span><br></pre></td></tr></table></figure>
<h3 id="检查-sql-语句-2">检查 SQL 语句</h3>
<p><code>OrderItems</code> 表含有 <code>order_num</code> 订单号</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a002</td>
</tr>
<tr class="even">
<td>a002</td>
</tr>
<tr class="odd">
<td>a002</td>
</tr>
<tr class="even">
<td>a004</td>
</tr>
<tr class="odd">
<td>a007</td>
</tr>
</tbody>
</table>
<p>【问题】将下面代码修改正确后执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT order_num, COUNT(*) AS items</span><br><span class="line">FROM OrderItems</span><br><span class="line">GROUP BY items</span><br><span class="line">HAVING COUNT(*) &gt;= 3</span><br><span class="line">ORDER BY items, order_num;</span><br></pre></td></tr></table></figure>
<p>修改后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT order_num, COUNT(*) AS items</span><br><span class="line">FROM OrderItems</span><br><span class="line">GROUP BY order_num</span><br><span class="line">HAVING items &gt;= 3</span><br><span class="line">ORDER BY items, order_num;</span><br></pre></td></tr></table></figure>
<h2 id="使用子查询">使用子查询</h2>
<p>子查询是嵌套在较大查询中的 SQL
查询，也称内部查询或内部选择，包含子查询的语句也称为外部查询或外部选择。简单来说，子查询就是指将一个
<code>select</code> 查询（子查询）的结果作为另一个 SQL
语句（主查询）的数据来源或者判断条件。</p>
<p>子查询可以嵌入
<code>select</code>、<code>insert</code>、<code>update</code> 和
<code>delete</code> 语句中，也可以和
<code>=</code>、<code>&lt;</code>、<code>&gt;</code>、<code>in</code>、<code>between</code>、<code>exists</code>
等运算符一起使用。</p>
<p>子查询常用在 <code>where</code> 子句和 <code>from</code>
子句后边：</p>
<ul>
<li>当用于 <code>where</code>
子句时，根据不同的运算符，子查询可以返回单行单列、多行单列、单行多列数据。子查询就是要返回能够作为
WHERE 子句查询条件的值。</li>
<li>当用于 <code>from</code>
子句时，一般返回多行多列数据，相当于返回一张临时表，这样才符合
<code>from</code> 后面是表的规则。这种做法能够实现多表联合查询。</li>
</ul>
<blockquote>
<p>注意：MySQL 数据库从 4.1
版本才开始支持子查询，早期版本是不支持的。</p>
</blockquote>
<p>用于 <code>where</code> 子句的子查询的基本语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select column_name [, column_name ]</span><br><span class="line">from   table1 [, table2 ]</span><br><span class="line">where  column_name operator</span><br><span class="line">    (select column_name [, column_name ]</span><br><span class="line">    from table1 [, table2 ]</span><br><span class="line">    [where])</span><br></pre></td></tr></table></figure>
<ul>
<li>子查询需要放在括号<code>( )</code>内。</li>
<li><code>operator</code> 表示用于 where 子句的运算符。</li>
</ul>
<p>用于 <code>from</code> 子句的子查询的基本语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select column_name [, column_name ]</span><br><span class="line">from (select column_name [, column_name ]</span><br><span class="line">      from table1 [, table2 ]</span><br><span class="line">      [where]) as temp_table_name</span><br><span class="line">where  condition</span><br></pre></td></tr></table></figure>
<p>用于 <code>from</code>
的子查询返回的结果相当于一张临时表，所以需要使用 AS
关键字为该临时表起一个名字。</p>
<h3 id="返回购买价格为-10-美元或以上产品的顾客列表">返回购买价格为 10
美元或以上产品的顾客列表</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderItems` 表示订单商品表，含有字段  </span><br><span class="line">订单号：`order_num`、</span><br><span class="line">订单价格：`item_price`；</span><br><span class="line">`Orders` 表代表订单信息表，含有</span><br><span class="line">顾客 `id：cust_id` 和</span><br><span class="line">订单号：`order_num</span><br></pre></td></tr></table></figure>
<p><code>OrderItems</code> 表:</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>item_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>1</td>
</tr>
<tr class="even">
<td>a4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>5</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust2</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust5</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>cust7</td>
</tr>
</tbody>
</table>
<p>【问题】使用子查询，返回购买价格为 10
美元或以上产品的顾客列表，结果无需排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_id</span><br><span class="line">from Orders</span><br><span class="line">where order_num in (</span><br><span class="line">    select order_num</span><br><span class="line">    from OrderItems</span><br><span class="line">    group by order_num</span><br><span class="line">    having sum(item_price) &gt;= 10</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="确定哪些订单购买了-prod_id-为-br01-的产品一">确定哪些订单购买了
prod_id 为 BR01 的产品（一）</h3>
<p>表 <code>OrderItems</code> 代表订单商品信息表，<code>prod_id</code>
为产品 id；<code>Orders</code> 表代表订单表有 <code>cust_id</code>
代表顾客 id 和订单日期 <code>order_date</code></p>
<p><code>OrderItems</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BR01</td>
<td>a0001</td>
</tr>
<tr class="even">
<td>BR01</td>
<td>a0002</td>
</tr>
<tr class="odd">
<td>BR02</td>
<td>a0003</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a0013</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>cust10</td>
<td>2022-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>cust1</td>
<td>2022-01-01 00:01:00</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>cust1</td>
<td>2022-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>cust2</td>
<td>2022-01-01 00:20:00</td>
</tr>
</tbody>
</table>
<p>【问题】</p>
<p>编写 SQL 语句，使用子查询来确定哪些订单（在 <code>OrderItems</code>
中）购买了 <code>prod_id</code> 为 "BR01" 的产品，然后从
<code>Orders</code> 表中返回每个产品对应的顾客
ID（<code>cust_id</code>）和订单日期（<code>order_date</code>），按订购日期对结果进行升序排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 写法 1：子查询</span><br><span class="line">select cust_id, order_date</span><br><span class="line">from Orders</span><br><span class="line">where order_num in (</span><br><span class="line">    select order_num</span><br><span class="line">    from OrderItems</span><br><span class="line">    where prod_id = &#x27;BR01&#x27;</span><br><span class="line">)</span><br><span class="line">order by order_date;</span><br><span class="line"></span><br><span class="line"># 写法 2: 连接表</span><br><span class="line">select</span><br><span class="line">    b.cust_id, b.order_date</span><br><span class="line">from</span><br><span class="line">    OrderItems a, Orders b</span><br><span class="line">where</span><br><span class="line">    a.order_num = b.order_num</span><br><span class="line">    and a.prod_id = &#x27;BR01&#x27;</span><br><span class="line">order by</span><br><span class="line">    order_date;</span><br></pre></td></tr></table></figure>
<h3 id="返回购买-prod_id-为-br01-的产品的所有顾客的电子邮件一">返回购买
prod_id 为 BR01 的产品的所有顾客的电子邮件（一）</h3>
<p>你想知道订购 BR01 产品的日期，有表 <code>OrderItems</code>
代表订单商品信息表，<code>prod_id</code> 为产品 id；<code>Orders</code>
表代表订单表有 <code>cust_id</code> 代表顾客 id 和订单日期
<code>order_date</code>；<code>Customers</code> 表含有
<code>cust_email</code> 顾客邮件和 <code>cust_id</code> 顾客 id</p>
<p><code>OrderItems</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BR01</td>
<td>a0001</td>
</tr>
<tr class="even">
<td>BR01</td>
<td>a0002</td>
</tr>
<tr class="odd">
<td>BR02</td>
<td>a0003</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a0013</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>cust10</td>
<td>2022-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>cust1</td>
<td>2022-01-01 00:01:00</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>cust1</td>
<td>2022-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>cust2</td>
<td>2022-01-01 00:20:00</td>
</tr>
</tbody>
</table>
<p><code>Customers</code> 表代表顾客信息，<code>cust_id</code> 为顾客
id，<code>cust_email</code> 为顾客 email</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td><a href="mailto:cust10@cust.com">cust10@cust.com</a></td>
</tr>
<tr class="even">
<td>cust1</td>
<td><a href="mailto:cust1@cust.com">cust1@cust.com</a></td>
</tr>
<tr class="odd">
<td>cust2</td>
<td><a href="mailto:cust2@cust.com">cust2@cust.com</a></td>
</tr>
</tbody>
</table>
<p>【问题】返回购买 <code>prod_id</code> 为 <code>BR01</code>
的产品的所有顾客的电子邮件（<code>Customers</code> 表中的
<code>cust_email</code>），结果无需排序。</p>
<p>提示：这涉及 <code>SELECT</code> 语句，最内层的从
<code>OrderItems</code> 表返回 <code>order_num</code>，中间的从
<code>Customers</code> 表返回 <code>cust_id</code>。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 写法 1：子查询</span><br><span class="line">select cust_email</span><br><span class="line">from Customers</span><br><span class="line">where cust_id in (</span><br><span class="line">    select cust_id</span><br><span class="line">    from Orders</span><br><span class="line">    where order_num in (</span><br><span class="line">        select order_num</span><br><span class="line">        from OrderItems</span><br><span class="line">        where prod_id = &#x27;BR01&#x27;</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># 写法 2: 连接表（inner join）</span><br><span class="line">select c.cust_email</span><br><span class="line">from OrderItems a, Orders b, Customers c</span><br><span class="line">where a.order_num = b.order_num</span><br><span class="line">    and b.cust_id = c.cust_id</span><br><span class="line">    and a.prod_id = &#x27;BR01&#x27;;</span><br><span class="line"></span><br><span class="line"># 写法 3：连接表（left join）</span><br><span class="line">select</span><br><span class="line">    c.cust_email</span><br><span class="line">from</span><br><span class="line">    Orders a</span><br><span class="line">    left join OrderItems b on a.order_num = b.order_num</span><br><span class="line">    left join Customers c on a.cust_id = c.cust_id</span><br><span class="line">where</span><br><span class="line">    b.prod_id = &#x27;BR01&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="返回每个顾客不同订单的总金额">返回每个顾客不同订单的总金额</h3>
<p>我们需要一个顾客 ID 列表，其中包含他们已订购的总金额。</p>
<p><code>OrderItems</code> 表代表订单信息，<code>OrderItems</code>
表有订单号：<code>order_num</code>
和商品售出价格：<code>item_price</code>、商品数量：<code>quantity</code>。</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>item_price</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>10</td>
<td>105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>1</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>1</td>
<td>200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>2</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>5</td>
<td>10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>7</td>
<td>5</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Orders` 表订单号：`order_num`、顾客 id：`cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>cust1</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>cust2</td>
</tr>
</tbody>
</table>
<p>【问题】</p>
<p>编写 SQL 语句，返回顾客 ID（<code>Orders</code> 表中的
<code>cust_id</code>），并使用子查询返回 <code>total_ordered</code>
以便返回每个顾客的订单总数，将结果按金额从大到小排序。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 写法 1：子查询</span><br><span class="line">SELECT</span><br><span class="line">    o.cust_id cust_id,</span><br><span class="line">    tb.total_ordered total_ordered</span><br><span class="line">FROM (</span><br><span class="line">    SELECT order_num, SUM(item_price * quantity) total_ordered</span><br><span class="line">    FROM OrderItems</span><br><span class="line">    GROUP BY order_num</span><br><span class="line">    ) as tb,</span><br><span class="line">    Orders o</span><br><span class="line">WHERE</span><br><span class="line">    tb.order_num = o.order_num</span><br><span class="line">ORDER BY</span><br><span class="line">    total_ordered DESC;</span><br><span class="line"></span><br><span class="line"># 写法 2：连接表</span><br><span class="line">select b.cust_id, sum(a.quantity * a.item_price) as total_ordered</span><br><span class="line">from OrderItems a, Orders b</span><br><span class="line">where a.order_num = b.order_num</span><br><span class="line">group by cust_id</span><br><span class="line">order by total_ordered desc;</span><br></pre></td></tr></table></figure>
<h3 id="从-products-表中检索所有的产品名称以及对应的销售总数">从
Products 表中检索所有的产品名称以及对应的销售总数</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Products` 表中检索所有的产品名称：`prod_name`、产品 id：`prod_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>egg</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>sockets</td>
</tr>
<tr class="odd">
<td>a0013</td>
<td>coffee</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>cola</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderItems` 代表订单商品表，订单产品：`prod_id`、售出数量：`quantity</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>【问题】</p>
<p>编写 SQL 语句，从 <code>Products</code>
表中检索所有的产品名称（<code>prod_name</code>），以及名为
<code>quant_sold</code> 的计算列，其中包含所售产品的总数（在
<code>OrderItems</code> 表上使用子查询和 <code>SUM(quantity)</code>
检索）。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 写法 1：子查询</span><br><span class="line">select p.prod_name, tb.quant_sold</span><br><span class="line">from (</span><br><span class="line">    select prod_id, sum(quantity) as quant_sold</span><br><span class="line">    from OrderItems</span><br><span class="line">    group by prod_id</span><br><span class="line">    ) as tb,</span><br><span class="line">    Products p</span><br><span class="line">where tb.prod_id = p.prod_id;</span><br><span class="line"></span><br><span class="line"># 写法 2：连接表</span><br><span class="line">select p.prod_name, sum(o.quantity) as quant_sold</span><br><span class="line">from Products p, OrderItems o</span><br><span class="line">where p.prod_id = o.prod_id</span><br><span class="line">group by p.prod_name;（这里不能用 p.prod_id，会报错）</span><br></pre></td></tr></table></figure>
<h2 id="连接表">连接表</h2>
<p>JOIN 是“连接”的意思，顾名思义，SQL JOIN
子句用于将两个或者多个表联合起来进行查询。</p>
<p>连接表时需要在每个表中选择一个字段，并对这些字段的值进行比较，值相同的两条记录将合并为一条。<strong>连接表的本质就是将不同表的记录合并起来，形成一张新表。当然，这张新表只是临时的，它仅存在于本次查询期间</strong>。</p>
<p>使用 <code>JOIN</code> 连接两个表的基本语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table1.column1, table2.column2...</span><br><span class="line">from table1</span><br><span class="line">join table2</span><br><span class="line">on table1.common_column1 = table2.common_column2;</span><br></pre></td></tr></table></figure>
<p><code>table1.common_column1 = table2.common_column2</code>
是连接条件，只有满足此条件的记录才会合并为一行。您可以使用多个运算符来连接表，例如
=、&gt;、&lt;、&lt;&gt;、&lt;=、&gt;=、!=、<code>between</code>、<code>like</code>
或者 <code>not</code>，但是最常见的是使用 =。</p>
<p>当两个表中有同名的字段时，为了帮助数据库引擎区分是哪个表的字段，在书写同名字段名时需要加上表名。当然，如果书写的字段名在两个表中是唯一的，也可以不使用以上格式，只写字段名即可。</p>
<p>另外，如果两张表的关联字段名相同，也可以使用
<code>USING</code>子句来代替 <code>ON</code>，举个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># join....on</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c</span><br><span class="line">inner join Orders o</span><br><span class="line">on c.cust_id = o.cust_id</span><br><span class="line">order by c.cust_name;</span><br><span class="line"></span><br><span class="line"># 如果两张表的关联字段名相同，也可以使用USING子句：join....using()</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c</span><br><span class="line">inner join Orders o</span><br><span class="line">using(cust_id)</span><br><span class="line">order by c.cust_name;</span><br></pre></td></tr></table></figure>
<p><strong><code>ON</code> 和 <code>WHERE</code> 的区别</strong>：</p>
<ul>
<li>连接表时，SQL 会根据连接条件生成一张新的临时表。<code>ON</code>
就是连接条件，它决定临时表的生成。</li>
<li><code>WHERE</code>
是在临时表生成以后，再对临时表中的数据进行过滤，生成最终的结果集，这个时候已经没有
JOIN-ON 了。</li>
</ul>
<p>所以总结来说就是：<strong>SQL 先根据 ON 生成一张临时表，然后再根据
WHERE 对临时表进行筛选</strong>。</p>
<p>SQL 允许在 <code>JOIN</code>
左边加上一些修饰性的关键词，从而形成不同类型的连接，如下表所示：</p>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th>连接类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>INNER JOIN 内连接</td>
<td>（默认连接方式）只有当两个表都存在满足条件的记录时才会返回行。</td>
</tr>
<tr class="even">
<td>LEFT JOIN / LEFT OUTER JOIN 左(外)连接</td>
<td>返回左表中的所有行，即使右表中没有满足条件的行也是如此。</td>
</tr>
<tr class="odd">
<td>RIGHT JOIN / RIGHT OUTER JOIN 右(外)连接</td>
<td>返回右表中的所有行，即使左表中没有满足条件的行也是如此。</td>
</tr>
<tr class="even">
<td>FULL JOIN / FULL OUTER JOIN 全(外)连接</td>
<td>只要其中有一个表存在满足条件的记录，就返回行。</td>
</tr>
<tr class="odd">
<td>SELF JOIN</td>
<td>将一个表连接到自身，就像该表是两个表一样。为了区分两个表，在 SQL
语句中需要至少重命名一个表。</td>
</tr>
<tr class="even">
<td>CROSS JOIN</td>
<td>交叉连接，从两个或者多个连接表中返回记录集的笛卡尔积。</td>
</tr>
</tbody>
</table>
<p>下图展示了 LEFT JOIN、RIGHT JOIN、INNER JOIN、OUTER JOIN 相关的 7
种用法。</p>
<figure>
<img
src="https://raw.githubusercontent.com/lwmfjc/lwmfjc.github.io.resource/main/img/image-20230312175507026.png"
alt="image-20230312175507026" />
<figcaption aria-hidden="true">image-20230312175507026</figcaption>
</figure>
<p>如果不加任何修饰词，只写 <code>JOIN</code>，那么默认为
<code>INNER JOIN</code></p>
<p>对于 <code>INNER JOIN</code> 来说，还有一种隐式的写法，称为
“<strong>隐式内连接</strong>”，也就是没有 <code>INNER JOIN</code>
关键字，使用 <code>WHERE</code> 语句实现内连接的功能</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 隐式内连接</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c, Orders o</span><br><span class="line">where c.cust_id = o.cust_id</span><br><span class="line">order by c.cust_name;</span><br><span class="line"></span><br><span class="line"># 显式内连接</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c inner join Orders o</span><br><span class="line">using(cust_id)</span><br><span class="line">order by c.cust_name;</span><br></pre></td></tr></table></figure>
<h3 id="返回顾客名称和相关订单号">返回顾客名称和相关订单号</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Customers` 表有字段顾客名称 `cust_name`、顾客 id `cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>andy</td>
</tr>
<tr class="even">
<td>cust1</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>tony</td>
</tr>
<tr class="even">
<td>cust22</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>cust221</td>
<td>an</td>
</tr>
<tr class="even">
<td>cust2217</td>
<td>hex</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 订单信息表，含有字段 <code>order_num</code>
订单号、<code>cust_id</code> 顾客 id</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>cust2</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust22</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust221</td>
</tr>
<tr class="even">
<td>a7</td>
<td>cust2217</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回 <code>Customers</code>
表中的顾客名称（<code>cust_name</code>）和 <code>Orders</code>
表中的相关订单号（<code>order_num</code>），并按顾客名称再按订单号对结果进行升序排序。你可以尝试用两个不同的写法，一个使用简单的等连接语法，另外一个使用
INNER JOIN。</p>
<p>答案：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 隐式内连接</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c, Orders o</span><br><span class="line">where c.cust_id = o.cust_id</span><br><span class="line">order by c.cust_name;</span><br><span class="line"></span><br><span class="line"># 显式内连接</span><br><span class="line">select c.cust_name, o.order_num</span><br><span class="line">from Customers c inner join Orders o</span><br><span class="line">using(cust_id)</span><br><span class="line">order by c.cust_name;</span><br></pre></td></tr></table></figure>
<h3
id="返回顾客名称和相关订单号以及每个订单的总价">返回顾客名称和相关订单号以及每个订单的总价</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Customers` 表有字段，顾客名称：`cust_name`、顾客 id：`cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>andy</td>
</tr>
<tr class="even">
<td>cust1</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>tony</td>
</tr>
<tr class="even">
<td>cust22</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>cust221</td>
<td>an</td>
</tr>
<tr class="even">
<td>cust2217</td>
<td>hex</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Orders` 订单信息表，含有字段，订单号：`order_num`、顾客 id：`cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>cust2</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust22</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust221</td>
</tr>
<tr class="even">
<td>a7</td>
<td>cust2217</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderItems` 表有字段，商品订单号：`order_num`、商品数量：`quantity`、商品价格：`item_price</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>quantity</th>
<th>item_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>1000</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>200</td>
<td>10</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>10</td>
<td>15</td>
</tr>
<tr class="even">
<td>a4</td>
<td>25</td>
<td>50</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>15</td>
<td>25</td>
</tr>
<tr class="even">
<td>a7</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>【问题】除了返回顾客名称和订单号，返回 <code>Customers</code>
表中的顾客名称（<code>cust_name</code>）和 <code>Orders</code>
表中的相关订单号（<code>order_num</code>），添加第三列
<code>OrderTotal</code>，其中包含每个订单的总价，并按顾客名称再按订单号对结果进行升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 简单的等连接语法</span><br><span class="line">select c.cust_name, o.order_num, sum(quantity * item_price) as OrderTotal</span><br><span class="line">from Customers c, Orders o, OrderItems oi</span><br><span class="line">where c.cust_id = o.cust_id</span><br><span class="line">    and o.order_num = oi.order_num</span><br><span class="line">group by c.cust_name, o.order_num</span><br><span class="line">order by c.cust_name, o.order_num;</span><br></pre></td></tr></table></figure>
<p>注意，可能有小伙伴会这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select c.cust_name, o.order_num, sum(quantity * item_price) as OrderTotal</span><br><span class="line">from Customers c, Orders o, OrderItems oi</span><br><span class="line">where c.cust_id = o.cust_id</span><br><span class="line">    and o.order_num = oi.order_num</span><br><span class="line">group by c.cust_name</span><br><span class="line">order by c.cust_name, o.order_num;</span><br></pre></td></tr></table></figure>
<p>这是错误的！只对 <code>cust_name</code>
进行聚类确实符合题意，但是不符合 <code>group by</code> 的语法。</p>
<p>select 语句中，如果没有 <code>group by</code> 语句，那么
<code>cust_name</code>、<code>order_num</code> 会返回若干个值，而
<code>sum(quantity _ item_price)</code> 只返回一个值，通过
<code>group by</code> <code>cust_name</code> 可以让
<code>cust_name</code> 和 <code>sum(quantity _ item_price)</code>
一一对应起来，或者说<strong>聚类</strong>，所以同样的，也要对
<code>order_num</code> 进行聚类。</p>
<blockquote>
<p><strong>一句话，select 中的字段要么都聚类，要么都不聚类</strong></p>
</blockquote>
<h3 id="确定哪些订单购买了-prod_id-为-br01-的产品二">确定哪些订单购买了
prod_id 为 BR01 的产品（二）</h3>
<p>表 <code>OrderItems</code> 代表订单商品信息表，<code>prod_id</code>
为产品 id；<code>Orders</code> 表代表订单表有 <code>cust_id</code>
代表顾客 id 和订单日期 <code>order_date</code></p>
<p><code>OrderItems</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BR01</td>
<td>a0001</td>
</tr>
<tr class="even">
<td>BR01</td>
<td>a0002</td>
</tr>
<tr class="odd">
<td>BR02</td>
<td>a0003</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a0013</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>cust10</td>
<td>2022-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>cust1</td>
<td>2022-01-01 00:01:00</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>cust1</td>
<td>2022-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>cust2</td>
<td>2022-01-01 00:20:00</td>
</tr>
</tbody>
</table>
<p>【问题】</p>
<p>编写 SQL 语句，使用子查询来确定哪些订单（在 <code>OrderItems</code>
中）购买了 <code>prod_id</code> 为 "BR01" 的产品，然后从
<code>Orders</code> 表中返回每个产品对应的顾客
ID（<code>cust_id</code>）和订单日期（<code>order_date</code>），按订购日期对结果进行升序排序。</p>
<p>提示：这一次使用连接和简单的等连接语法。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 写法 1：子查询</span><br><span class="line">select cust_id, order_date</span><br><span class="line">from Orders</span><br><span class="line">where order_num in (</span><br><span class="line">    select order_num</span><br><span class="line">    from OrderItems</span><br><span class="line">    where prod_id = &#x27;BR01&#x27;</span><br><span class="line">)</span><br><span class="line">order by order_date;</span><br><span class="line"></span><br><span class="line"># 写法 2：连接表 inner join</span><br><span class="line">select cust_id, order_date</span><br><span class="line">from Orders o inner join (</span><br><span class="line">    select order_num</span><br><span class="line">    from OrderItems</span><br><span class="line">    where prod_id = &#x27;BR01&#x27;</span><br><span class="line">) tb on o.order_num = tb.order_num</span><br><span class="line">order by order_date;</span><br><span class="line"></span><br><span class="line"># 写法 3：写法 2 的简化版</span><br><span class="line">select cust_id, order_date</span><br><span class="line">from Orders</span><br><span class="line">inner join OrderItems using(order_num)</span><br><span class="line">where OrderItems.prod_id = &#x27;BR01&#x27;</span><br><span class="line">order by order_date;</span><br></pre></td></tr></table></figure>
<h3 id="返回购买-prod_id-为-br01-的产品的所有顾客的电子邮件二">返回购买
prod_id 为 BR01 的产品的所有顾客的电子邮件（二）</h3>
<p>有表 <code>OrderItems</code> 代表订单商品信息表，<code>prod_id</code>
为产品 id；<code>Orders</code> 表代表订单表有 <code>cust_id</code>
代表顾客 id 和订单日期 <code>order_date</code>；<code>Customers</code>
表含有 <code>cust_email</code> 顾客邮件和 cust_id 顾客 id</p>
<p><code>OrderItems</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BR01</td>
<td>a0001</td>
</tr>
<tr class="even">
<td>BR01</td>
<td>a0002</td>
</tr>
<tr class="odd">
<td>BR02</td>
<td>a0003</td>
</tr>
<tr class="even">
<td>BR02</td>
<td>a0013</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表：</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
<th>order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>cust10</td>
<td>2022-01-01 00:00:00</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>cust1</td>
<td>2022-01-01 00:01:00</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>cust1</td>
<td>2022-01-02 00:00:00</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>cust2</td>
<td>2022-01-01 00:20:00</td>
</tr>
</tbody>
</table>
<p><code>Customers</code> 表代表顾客信息，<code>cust_id</code> 为顾客
id，<code>cust_email</code> 为顾客 email</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td><a href="mailto:cust10@cust.com">cust10@cust.com</a></td>
</tr>
<tr class="even">
<td>cust1</td>
<td><a href="mailto:cust1@cust.com">cust1@cust.com</a></td>
</tr>
<tr class="odd">
<td>cust2</td>
<td><a href="mailto:cust2@cust.com">cust2@cust.com</a></td>
</tr>
</tbody>
</table>
<p>【问题】返回购买 <code>prod_id</code> 为 BR01
的产品的所有顾客的电子邮件（<code>Customers</code> 表中的
<code>cust_email</code>），结果无需排序。</p>
<p>提示：涉及到 <code>SELECT</code> 语句，最内层的从
<code>OrderItems</code> 表返回 <code>order_num</code>，中间的从
<code>Customers</code> 表返回 <code>cust_id</code>，但是必须使用 INNER
JOIN 语法。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_email</span><br><span class="line">from Customers</span><br><span class="line">inner join Orders using(cust_id)</span><br><span class="line">inner join OrderItems using(order_num)</span><br><span class="line">where OrderItems.prod_id = &#x27;BR01&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="确定最佳顾客的另一种方式二">确定最佳顾客的另一种方式（二）</h3>
<p><code>OrderItems</code>
表代表订单信息，确定最佳顾客的另一种方式是看他们花了多少钱，<code>OrderItems</code>
表有订单号 <code>order_num</code> 和 <code>item_price</code>
商品售出价格、<code>quantity</code> 商品数量</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>item_price</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>10</td>
<td>105</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
<td>1100</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>1</td>
<td>200</td>
</tr>
<tr class="even">
<td>a4</td>
<td>2</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>5</td>
<td>10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a7</td>
<td>7</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><code>Orders</code> 表含有字段 <code>order_num</code>
订单号、<code>cust_id</code> 顾客 id</p>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>cust2</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust22</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust221</td>
</tr>
<tr class="even">
<td>a7</td>
<td>cust2217</td>
</tr>
</tbody>
</table>
<p>顾客表 <code>Customers</code> 有字段 <code>cust_id</code> 客户
id、<code>cust_name</code> 客户姓名</p>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>andy</td>
</tr>
<tr class="even">
<td>cust1</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>tony</td>
</tr>
<tr class="even">
<td>cust22</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>cust221</td>
<td>an</td>
</tr>
<tr class="even">
<td>cust2217</td>
<td>hex</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，返回订单总价不小于 1000
的客户名称和总额（<code>OrderItems</code> 表中的
<code>order_num</code>）。</p>
<p>提示：需要计算总和（<code>item_price</code> 乘以
<code>quantity</code>）。按总额对结果进行排序，请使用 INNER JOIN
语法。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_name, sum(item_price * quantity) as total_price</span><br><span class="line">from Customers</span><br><span class="line">inner join Orders using(cust_id)</span><br><span class="line">inner join OrderItems using(order_num)</span><br><span class="line">group by cust_name</span><br><span class="line">having total_price &gt;= 1000</span><br><span class="line">order by total_price;</span><br></pre></td></tr></table></figure>
<h2 id="创建高级连接">创建高级连接</h2>
<h3
id="检索每个顾客的名称和所有的订单号一">检索每个顾客的名称和所有的订单号（一）</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Customers` 表代表顾客信息含有顾客 id `cust_id` 和 顾客名称 `cust_name</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>andy</td>
</tr>
<tr class="even">
<td>cust1</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>tony</td>
</tr>
<tr class="even">
<td>cust22</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>cust221</td>
<td>an</td>
</tr>
<tr class="even">
<td>cust2217</td>
<td>hex</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Orders` 表代表订单信息含有订单号 `order_num` 和顾客 id `cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>cust2</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust22</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust221</td>
</tr>
<tr class="even">
<td>a7</td>
<td>cust2217</td>
</tr>
</tbody>
</table>
<p>【问题】使用 INNER JOIN 编写 SQL
语句，检索每个顾客的名称（<code>Customers</code> 表中的
<code>cust_name</code>）和所有的订单号（<code>Orders</code> 表中的
<code>order_num</code>），最后根据顾客姓名 <code>cust_name</code>
升序返回。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_name, order_num</span><br><span class="line">from Customers</span><br><span class="line">inner join Orders</span><br><span class="line">using(cust_id)</span><br><span class="line">order by cust_name;</span><br></pre></td></tr></table></figure>
<h3
id="检索每个顾客的名称和所有的订单号二">检索每个顾客的名称和所有的订单号（二）</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Orders` 表代表订单信息含有订单号 `order_num` 和顾客 id `cust_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>order_num</th>
<th>cust_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>cust10</td>
</tr>
<tr class="even">
<td>a2</td>
<td>cust1</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>cust2</td>
</tr>
<tr class="even">
<td>a4</td>
<td>cust22</td>
</tr>
<tr class="odd">
<td>a5</td>
<td>cust221</td>
</tr>
<tr class="even">
<td>a7</td>
<td>cust2217</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Customers` 表代表顾客信息含有顾客 id `cust_id` 和 顾客名称 `cust_name</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>cust_id</th>
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>andy</td>
</tr>
<tr class="even">
<td>cust1</td>
<td>ben</td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>tony</td>
</tr>
<tr class="even">
<td>cust22</td>
<td>tom</td>
</tr>
<tr class="odd">
<td>cust221</td>
<td>an</td>
</tr>
<tr class="even">
<td>cust2217</td>
<td>hex</td>
</tr>
<tr class="odd">
<td>cust40</td>
<td>ace</td>
</tr>
</tbody>
</table>
<p>【问题】检索每个顾客的名称（<code>Customers</code> 表中的
<code>cust_name</code>）和所有的订单号（Orders 表中的
<code>order_num</code>），列出所有的顾客，即使他们没有下过订单。最后根据顾客姓名
<code>cust_name</code> 升序返回。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select cust_name, order_num</span><br><span class="line">from Customers</span><br><span class="line">left join Orders</span><br><span class="line">using(cust_id)</span><br><span class="line">order by cust_name;</span><br></pre></td></tr></table></figure>
<h3
id="返回产品名称和与之相关的订单号">返回产品名称和与之相关的订单号</h3>
<p><code>Products</code> 表为产品信息表含有字段 <code>prod_id</code>
产品 id、<code>prod_name</code> 产品名称</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>egg</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>sockets</td>
</tr>
<tr class="odd">
<td>a0013</td>
<td>coffee</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>cola</td>
</tr>
<tr class="odd">
<td>a0023</td>
<td>soda</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderItems` 表为订单信息表含有字段 `order_num` 订单号和产品 id `prod_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>a105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>a1100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>a200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>a1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>a10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>a19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>a5</td>
</tr>
</tbody>
</table>
<p>【问题】使用外连接（left join、 right join、full join）联结
<code>Products</code> 表和 <code>OrderItems</code>
表，返回产品名称（<code>prod_name</code>）和与之相关的订单号（<code>order_num</code>）的列表，并按照产品名称升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, order_num</span><br><span class="line">from Products</span><br><span class="line">left join OrderItems</span><br><span class="line">using(prod_id)</span><br><span class="line">order by prod_name;</span><br></pre></td></tr></table></figure>
<h3
id="返回产品名称和每一项产品的总订单数">返回产品名称和每一项产品的总订单数</h3>
<p><code>Products</code> 表为产品信息表含有字段 <code>prod_id</code>
产品 id、<code>prod_name</code> 产品名称</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>prod_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>egg</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>sockets</td>
</tr>
<tr class="odd">
<td>a0013</td>
<td>coffee</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>cola</td>
</tr>
<tr class="odd">
<td>a0023</td>
<td>soda</td>
</tr>
</tbody>
</table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrderItems` 表为订单信息表含有字段 `order_num` 订单号和产品 id `prod_id</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>order_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>a105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>a1100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>a200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>a1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>a10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>a19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>a5</td>
</tr>
</tbody>
</table>
<p>【问题】</p>
<p>使用 OUTER JOIN 联结 <code>Products</code> 表和
<code>OrderItems</code>
表，返回产品名称（<code>prod_name</code>）和每一项产品的总订单数（不是订单号），并按产品名称升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_name, count(order_num) as orders</span><br><span class="line">from Products</span><br><span class="line">left join OrderItems</span><br><span class="line">using(prod_id)</span><br><span class="line">group by prod_name</span><br><span class="line">order by prod_name;</span><br></pre></td></tr></table></figure>
<h3 id="列出供应商及其可供产品的数量">列出供应商及其可供产品的数量</h3>
<p>有 <code>Vendors</code> 表含有 <code>vend_id</code> （供应商 id）</p>
<table>
<thead>
<tr class="header">
<th>vend_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0002</td>
</tr>
<tr class="even">
<td>a0013</td>
</tr>
<tr class="odd">
<td>a0003</td>
</tr>
<tr class="even">
<td>a0010</td>
</tr>
</tbody>
</table>
<p>有 <code>Products</code> 表含有 <code>vend_id</code>（供应商 id）和
prod_id（供应产品 id）</p>
<table>
<thead>
<tr class="header">
<th>vend_id</th>
<th>prod_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>egg</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>prod_id_iphone</td>
</tr>
<tr class="odd">
<td>a00113</td>
<td>prod_id_tea</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>prod_id_vivo phone</td>
</tr>
<tr class="odd">
<td>a0010</td>
<td>prod_id_huawei phone</td>
</tr>
</tbody>
</table>
<p>【问题】列出供应商（<code>Vendors</code> 表中的
<code>vend_id</code>）及其可供产品的数量，包括没有产品的供应商。你需要使用
OUTER JOIN 和 COUNT()聚合函数来计算 <code>Products</code>
表中每种产品的数量，最后根据 vend_id 升序排序。</p>
<p>注意：<code>vend_id</code>
列会显示在多个表中，因此在每次引用它时都需要完全限定它。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select vend_id, count(prod_id) as prod_id</span><br><span class="line">from Vendors</span><br><span class="line">left join Products</span><br><span class="line">using(vend_id)</span><br><span class="line">group by vend_id</span><br><span class="line">order by vend_id;</span><br></pre></td></tr></table></figure>
<h2 id="组合查询">组合查询</h2>
<p><code>UNION</code>
运算符将两个或更多查询的结果组合起来，并生成一个结果集，其中包含来自
<code>UNION</code> 中参与查询的提取行。</p>
<p><code>UNION</code> 基本规则：</p>
<ul>
<li>所有查询的列数和列顺序必须相同。</li>
<li>每个查询中涉及表的列的数据类型必须相同或兼容。</li>
<li>通常返回的列名取自第一个查询。</li>
</ul>
<p>默认地，<code>UNION</code>
操作符选取不同的值。如果允许重复的值，请使用
<code>UNION ALL</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT column_name(s) FROM table1</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT column_name(s) FROM table2;</span><br></pre></td></tr></table></figure>
<p><code>UNION</code> 结果集中的列名总是等于 <code>UNION</code> 中第一个
<code>SELECT</code> 语句中的列名。</p>
<p><code>JOIN</code> vs <code>UNION</code>：</p>
<ul>
<li><code>JOIN</code> 中连接表的列可能不同，但在 <code>UNION</code>
中，所有查询的列数和列顺序必须相同。</li>
<li><code>UNION</code> 将查询之后的行放在一起（垂直放置），但
<code>JOIN</code>
将查询之后的列放在一起（水平放置），即它构成一个笛卡尔积。</li>
</ul>
<h3 id="将两个-select-语句结合起来一">将两个 SELECT
语句结合起来（一）</h3>
<p>表 <code>OrderItems</code> 包含订单产品信息，字段
<code>prod_id</code> 代表产品 id、<code>quantity</code> 代表产品数量</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>5</td>
</tr>
<tr class="even">
<td>BNBG</td>
<td>10002</td>
</tr>
</tbody>
</table>
<p>【问题】将两个 <code>SELECT</code> 语句结合起来，以便从
<code>OrderItems</code> 表中检索产品 id（<code>prod_id</code>）和
<code>quantity</code>。其中，一个 <code>SELECT</code> 语句过滤数量为 100
的行，另一个 <code>SELECT</code> 语句过滤 id 以 BNBG
开头的产品，最后按产品 id 对结果进行升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_id, quantity</span><br><span class="line">from OrderItems</span><br><span class="line">where quantity = 100</span><br><span class="line">union</span><br><span class="line">select prod_id, quantity</span><br><span class="line">from OrderItems</span><br><span class="line">where prod_id like &#x27;BNBG%&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="将两个-select-语句结合起来二">将两个 SELECT
语句结合起来（二）</h3>
<p>表 <code>OrderItems</code> 包含订单产品信息，字段
<code>prod_id</code> 代表产品 id、<code>quantity</code>
代表产品数量。</p>
<table>
<thead>
<tr class="header">
<th>prod_id</th>
<th>quantity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a0001</td>
<td>105</td>
</tr>
<tr class="even">
<td>a0002</td>
<td>100</td>
</tr>
<tr class="odd">
<td>a0002</td>
<td>200</td>
</tr>
<tr class="even">
<td>a0013</td>
<td>1121</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>10</td>
</tr>
<tr class="even">
<td>a0003</td>
<td>19</td>
</tr>
<tr class="odd">
<td>a0003</td>
<td>5</td>
</tr>
<tr class="even">
<td>BNBG</td>
<td>10002</td>
</tr>
</tbody>
</table>
<p>【问题】将两个 <code>SELECT</code> 语句结合起来，以便从
<code>OrderItems</code> 表中检索产品 id（<code>prod_id</code>）和
<code>quantity</code>。其中，一个 <code>SELECT</code> 语句过滤数量为 100
的行，另一个 <code>SELECT</code> 语句过滤 id 以 BNBG
开头的产品，最后按产品 id 对结果进行升序排序。
注意：<strong>这次仅使用单个 SELECT 语句。</strong></p>
<p>答案：</p>
<p>要求只用一条 select 语句，那就用 <code>or</code> 不用
<code>union</code> 了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select prod_id, quantity</span><br><span class="line">from OrderItems</span><br><span class="line">where quantity = 100 or prod_id like &#x27;BNBG%&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="组合-products-表中的产品名称和-customers-表中的顾客名称">组合
Products 表中的产品名称和 Customers 表中的顾客名称</h3>
<p><code>Products</code> 表含有字段 <code>prod_name</code>
代表产品名称</p>
<table>
<thead>
<tr class="header">
<th>prod_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flower</td>
</tr>
<tr class="even">
<td>rice</td>
</tr>
<tr class="odd">
<td>ring</td>
</tr>
<tr class="even">
<td>umbrella</td>
</tr>
</tbody>
</table>
<p>Customers 表代表顾客信息，cust_name 代表顾客名称</p>
<table>
<thead>
<tr class="header">
<th>cust_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>andy</td>
</tr>
<tr class="even">
<td>ben</td>
</tr>
<tr class="odd">
<td>tony</td>
</tr>
<tr class="even">
<td>tom</td>
</tr>
<tr class="odd">
<td>an</td>
</tr>
<tr class="even">
<td>lee</td>
</tr>
<tr class="odd">
<td>hex</td>
</tr>
</tbody>
</table>
<p>【问题】编写 SQL 语句，组合 <code>Products</code>
表中的产品名称（<code>prod_name</code>）和 <code>Customers</code>
表中的顾客名称（<code>cust_name</code>）并返回，然后按产品名称对结果进行升序排序。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名。</span><br><span class="line">select prod_name</span><br><span class="line">from Products</span><br><span class="line">union</span><br><span class="line">select cust_name</span><br><span class="line">from Customers</span><br><span class="line">order by prod_name;</span><br></pre></td></tr></table></figure>
<h3 id="检查-sql-语句-3">检查 SQL 语句</h3>
<p>表 <code>Customers</code> 含有字段 <code>cust_name</code>
顾客名、<code>cust_contact</code> 顾客联系方式、<code>cust_state</code>
顾客州、<code>cust_email</code> 顾客 <code>email</code></p>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="header">
<th>cust_name</th>
<th>cust_contact</th>
<th>cust_state</th>
<th>cust_email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cust10</td>
<td>8695192</td>
<td>MI</td>
<td><a href="mailto:cust10@cust.com">cust10@cust.com</a></td>
</tr>
<tr class="even">
<td>cust1</td>
<td>8695193</td>
<td>MI</td>
<td><a href="mailto:cust1@cust.com">cust1@cust.com</a></td>
</tr>
<tr class="odd">
<td>cust2</td>
<td>8695194</td>
<td>IL</td>
<td><a href="mailto:cust2@cust.com">cust2@cust.com</a></td>
</tr>
</tbody>
</table>
<p>【问题】修正下面错误的 SQL</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT cust_name, cust_contact, cust_email</span><br><span class="line">FROM Customers</span><br><span class="line">WHERE cust_state = &#x27;MI&#x27;</span><br><span class="line">ORDER BY cust_name;</span><br><span class="line">UNION</span><br><span class="line">SELECT cust_name, cust_contact, cust_email</span><br><span class="line">FROM Customers</span><br><span class="line">WHERE cust_state = &#x27;IL&#x27;ORDER BY cust_name;</span><br></pre></td></tr></table></figure>
<p>修正后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT cust_name, cust_contact, cust_email</span><br><span class="line">FROM Customers</span><br><span class="line">WHERE cust_state = &#x27;MI&#x27;</span><br><span class="line"></span><br><span class="line">UNION</span><br><span class="line">SELECT cust_name, cust_contact, cust_email</span><br><span class="line">FROM Customers</span><br><span class="line">WHERE cust_state = &#x27;IL&#x27;</span><br><span class="line"></span><br><span class="line">ORDER BY cust_name;</span><br></pre></td></tr></table></figure>
<p>使用 <code>union</code> 组合查询时，只能使用一条
<code>order by</code> 字句，他必须位于最后一条 <code>select</code>
语句之后</p>
<p>或者直接用 <code>or</code> 来做：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT cust_name, cust_contact, cust_email</span><br><span class="line">FROM Customers</span><br><span class="line">WHERE cust_state = &#x27;MI&#x27; or cust_state = &#x27;IL&#x27;</span><br><span class="line">ORDER BY cust_name;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%A4%8D%E4%B9%A0/" rel="tag"># 复习</a>
              <a href="/tags/%E5%A4%8D%E4%B9%A0-javaGuide/" rel="tag"># 复习-javaGuide</a>
              <a href="/tags/%E5%A4%8D%E4%B9%A0-javaGuide-database/" rel="tag"># 复习-javaGuide-database</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/03/12/review/java_guide/database/ly0504lysql-syntax-summary/" rel="prev" title="sql语法基础知识总结">
      <i class="fa fa-chevron-left"></i> sql语法基础知识总结
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/03/14/review/java_guide/database/mysql/ly0606lymysql-query-execution-plan/" rel="next" title="mysql执行计划">
      mysql执行计划 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="lwmfjc/lwmfjc.github.io.comment" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="nav-number">1.</span> <span class="nav-text">检索数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E-customers-%E8%A1%A8%E4%B8%AD%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E7%9A%84-id"><span class="nav-number">1.1.</span> <span class="nav-text">从 Customers 表中检索所有的
ID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%B9%B6%E5%88%97%E5%87%BA%E5%B7%B2%E8%AE%A2%E8%B4%AD%E4%BA%A7%E5%93%81%E7%9A%84%E6%B8%85%E5%8D%95"><span class="nav-number">1.2.</span> <span class="nav-text">检索并列出已订购产品的清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E5%88%97"><span class="nav-number">1.3.</span> <span class="nav-text">检索所有列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="nav-number">2.</span> <span class="nav-text">排序检索数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E9%A1%BE%E5%AE%A2%E5%90%8D%E7%A7%B0%E5%B9%B6%E4%B8%94%E6%8E%92%E5%BA%8F"><span class="nav-number">2.1.</span> <span class="nav-text">检索顾客名称并且排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E9%A1%BE%E5%AE%A2-id-%E5%92%8C%E6%97%A5%E6%9C%9F%E6%8E%92%E5%BA%8F"><span class="nav-number">2.2.</span> <span class="nav-text">对顾客 ID 和日期排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E7%85%A7%E6%95%B0%E9%87%8F%E5%92%8C%E4%BB%B7%E6%A0%BC%E6%8E%92%E5%BA%8F"><span class="nav-number">2.3.</span> <span class="nav-text">按照数量和价格排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-sql-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.4.</span> <span class="nav-text">检查 SQL 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">3.</span> <span class="nav-text">过滤数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%9B%BA%E5%AE%9A%E4%BB%B7%E6%A0%BC%E7%9A%84%E4%BA%A7%E5%93%81"><span class="nav-number">3.1.</span> <span class="nav-text">返回固定价格的产品</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%9B%B4%E9%AB%98%E4%BB%B7%E6%A0%BC%E7%9A%84%E4%BA%A7%E5%93%81"><span class="nav-number">3.2.</span> <span class="nav-text">返回更高价格的产品</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E4%BA%A7%E5%93%81%E5%B9%B6%E4%B8%94%E6%8C%89%E7%85%A7%E4%BB%B7%E6%A0%BC%E6%8E%92%E5%BA%8F"><span class="nav-number">3.3.</span> <span class="nav-text">返回产品并且按照价格排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%9B%B4%E5%A4%9A%E7%9A%84%E4%BA%A7%E5%93%81"><span class="nav-number">3.4.</span> <span class="nav-text">返回更多的产品</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%BF%87%E6%BB%A4"><span class="nav-number">4.</span> <span class="nav-text">高级数据过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%BE%9B%E5%BA%94%E5%95%86%E5%90%8D%E7%A7%B0"><span class="nav-number">4.1.</span> <span class="nav-text">检索供应商名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%B9%B6%E5%88%97%E5%87%BA%E5%B7%B2%E8%AE%A2%E8%B4%AD%E4%BA%A7%E5%93%81%E7%9A%84%E6%B8%85%E5%8D%95-1"><span class="nav-number">4.2.</span> <span class="nav-text">检索并列出已订购产品的清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%89%80%E6%9C%89%E4%BB%B7%E6%A0%BC%E5%9C%A8-3-%E7%BE%8E%E5%85%83%E5%88%B0-6-%E7%BE%8E%E5%85%83%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BA%A7%E5%93%81%E7%9A%84%E5%90%8D%E7%A7%B0%E5%92%8C%E4%BB%B7%E6%A0%BC"><span class="nav-number">4.3.</span> <span class="nav-text">返回所有价格在
3 美元到 6 美元之间的产品的名称和价格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-sql-%E8%AF%AD%E5%8F%A5-1"><span class="nav-number">4.4.</span> <span class="nav-text">检查 SQL 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="nav-number">5.</span> <span class="nav-text">用通配符进行过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E6%8F%8F%E8%BF%B0%E4%B8%80"><span class="nav-number">5.1.</span> <span class="nav-text">检索产品名称和描述（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E6%8F%8F%E8%BF%B0%E4%BA%8C"><span class="nav-number">5.2.</span> <span class="nav-text">检索产品名称和描述（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E6%8F%8F%E8%BF%B0%E4%B8%89"><span class="nav-number">5.3.</span> <span class="nav-text">检索产品名称和描述（三）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E6%8F%8F%E8%BF%B0%E5%9B%9B"><span class="nav-number">5.4.</span> <span class="nav-text">检索产品名称和描述（四）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">6.</span> <span class="nav-text">创建计算字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%AB%E5%90%8D"><span class="nav-number">6.1.</span> <span class="nav-text">别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E6%8A%98"><span class="nav-number">6.2.</span> <span class="nav-text">打折</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="nav-number">7.</span> <span class="nav-text">使用函数处理数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%BE%E5%AE%A2%E7%99%BB%E5%BD%95%E5%90%8D"><span class="nav-number">7.1.</span> <span class="nav-text">顾客登录名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E-2020-%E5%B9%B4-1-%E6%9C%88%E7%9A%84%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7%E5%92%8C%E8%AE%A2%E5%8D%95%E6%97%A5%E6%9C%9F"><span class="nav-number">7.2.</span> <span class="nav-text">返回 2020 年 1
月的所有订单的订单号和订单日期</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="nav-number">8.</span> <span class="nav-text">汇总数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E5%B7%B2%E5%94%AE%E5%87%BA%E4%BA%A7%E5%93%81%E7%9A%84%E6%80%BB%E6%95%B0"><span class="nav-number">8.1.</span> <span class="nav-text">确定已售出产品的总数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E5%B7%B2%E5%94%AE%E5%87%BA%E4%BA%A7%E5%93%81%E9%A1%B9-br01-%E7%9A%84%E6%80%BB%E6%95%B0"><span class="nav-number">8.2.</span> <span class="nav-text">确定已售出产品项 BR01 的总数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A-products-%E8%A1%A8%E4%B8%AD%E4%BB%B7%E6%A0%BC%E4%B8%8D%E8%B6%85%E8%BF%87-10-%E7%BE%8E%E5%85%83%E7%9A%84%E6%9C%80%E8%B4%B5%E4%BA%A7%E5%93%81%E7%9A%84%E4%BB%B7%E6%A0%BC"><span class="nav-number">8.3.</span> <span class="nav-text">确定
Products 表中价格不超过 10 美元的最贵产品的价格</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="nav-number">9.</span> <span class="nav-text">分组数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%AF%8F%E4%B8%AA%E8%AE%A2%E5%8D%95%E5%8F%B7%E5%90%84%E6%9C%89%E5%A4%9A%E5%B0%91%E8%A1%8C%E6%95%B0"><span class="nav-number">9.1.</span> <span class="nav-text">返回每个订单号各有多少行数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AF%8F%E4%B8%AA%E4%BE%9B%E5%BA%94%E5%95%86%E6%88%90%E6%9C%AC%E6%9C%80%E4%BD%8E%E7%9A%84%E4%BA%A7%E5%93%81"><span class="nav-number">9.2.</span> <span class="nav-text">每个供应商成本最低的产品</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E8%AE%A2%E5%8D%95%E6%95%B0%E9%87%8F%E6%80%BB%E5%92%8C%E4%B8%8D%E5%B0%8F%E4%BA%8E-100-%E7%9A%84%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7"><span class="nav-number">9.3.</span> <span class="nav-text">返回订单数量总和不小于
100 的所有订单的订单号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%80%BB%E5%92%8C"><span class="nav-number">9.4.</span> <span class="nav-text">计算总和</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-sql-%E8%AF%AD%E5%8F%A5-2"><span class="nav-number">9.5.</span> <span class="nav-text">检查 SQL 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.</span> <span class="nav-text">使用子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E8%B4%AD%E4%B9%B0%E4%BB%B7%E6%A0%BC%E4%B8%BA-10-%E7%BE%8E%E5%85%83%E6%88%96%E4%BB%A5%E4%B8%8A%E4%BA%A7%E5%93%81%E7%9A%84%E9%A1%BE%E5%AE%A2%E5%88%97%E8%A1%A8"><span class="nav-number">10.1.</span> <span class="nav-text">返回购买价格为 10
美元或以上产品的顾客列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E5%93%AA%E4%BA%9B%E8%AE%A2%E5%8D%95%E8%B4%AD%E4%B9%B0%E4%BA%86-prod_id-%E4%B8%BA-br01-%E7%9A%84%E4%BA%A7%E5%93%81%E4%B8%80"><span class="nav-number">10.2.</span> <span class="nav-text">确定哪些订单购买了
prod_id 为 BR01 的产品（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E8%B4%AD%E4%B9%B0-prod_id-%E4%B8%BA-br01-%E7%9A%84%E4%BA%A7%E5%93%81%E7%9A%84%E6%89%80%E6%9C%89%E9%A1%BE%E5%AE%A2%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E4%B8%80"><span class="nav-number">10.3.</span> <span class="nav-text">返回购买
prod_id 为 BR01 的产品的所有顾客的电子邮件（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E6%AF%8F%E4%B8%AA%E9%A1%BE%E5%AE%A2%E4%B8%8D%E5%90%8C%E8%AE%A2%E5%8D%95%E7%9A%84%E6%80%BB%E9%87%91%E9%A2%9D"><span class="nav-number">10.4.</span> <span class="nav-text">返回每个顾客不同订单的总金额</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E-products-%E8%A1%A8%E4%B8%AD%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E7%9A%84%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E4%BB%A5%E5%8F%8A%E5%AF%B9%E5%BA%94%E7%9A%84%E9%94%80%E5%94%AE%E6%80%BB%E6%95%B0"><span class="nav-number">10.5.</span> <span class="nav-text">从
Products 表中检索所有的产品名称以及对应的销售总数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E8%A1%A8"><span class="nav-number">11.</span> <span class="nav-text">连接表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E9%A1%BE%E5%AE%A2%E5%90%8D%E7%A7%B0%E5%92%8C%E7%9B%B8%E5%85%B3%E8%AE%A2%E5%8D%95%E5%8F%B7"><span class="nav-number">11.1.</span> <span class="nav-text">返回顾客名称和相关订单号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E9%A1%BE%E5%AE%A2%E5%90%8D%E7%A7%B0%E5%92%8C%E7%9B%B8%E5%85%B3%E8%AE%A2%E5%8D%95%E5%8F%B7%E4%BB%A5%E5%8F%8A%E6%AF%8F%E4%B8%AA%E8%AE%A2%E5%8D%95%E7%9A%84%E6%80%BB%E4%BB%B7"><span class="nav-number">11.2.</span> <span class="nav-text">返回顾客名称和相关订单号以及每个订单的总价</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E5%93%AA%E4%BA%9B%E8%AE%A2%E5%8D%95%E8%B4%AD%E4%B9%B0%E4%BA%86-prod_id-%E4%B8%BA-br01-%E7%9A%84%E4%BA%A7%E5%93%81%E4%BA%8C"><span class="nav-number">11.3.</span> <span class="nav-text">确定哪些订单购买了
prod_id 为 BR01 的产品（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E8%B4%AD%E4%B9%B0-prod_id-%E4%B8%BA-br01-%E7%9A%84%E4%BA%A7%E5%93%81%E7%9A%84%E6%89%80%E6%9C%89%E9%A1%BE%E5%AE%A2%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E4%BA%8C"><span class="nav-number">11.4.</span> <span class="nav-text">返回购买
prod_id 为 BR01 的产品的所有顾客的电子邮件（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E5%AE%9A%E6%9C%80%E4%BD%B3%E9%A1%BE%E5%AE%A2%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="nav-number">11.5.</span> <span class="nav-text">确定最佳顾客的另一种方式（二）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%AB%98%E7%BA%A7%E8%BF%9E%E6%8E%A5"><span class="nav-number">12.</span> <span class="nav-text">创建高级连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%AF%8F%E4%B8%AA%E9%A1%BE%E5%AE%A2%E7%9A%84%E5%90%8D%E7%A7%B0%E5%92%8C%E6%89%80%E6%9C%89%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7%E4%B8%80"><span class="nav-number">12.1.</span> <span class="nav-text">检索每个顾客的名称和所有的订单号（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%AF%8F%E4%B8%AA%E9%A1%BE%E5%AE%A2%E7%9A%84%E5%90%8D%E7%A7%B0%E5%92%8C%E6%89%80%E6%9C%89%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7%E4%BA%8C"><span class="nav-number">12.2.</span> <span class="nav-text">检索每个顾客的名称和所有的订单号（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E4%B8%8E%E4%B9%8B%E7%9B%B8%E5%85%B3%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7"><span class="nav-number">12.3.</span> <span class="nav-text">返回产品名称和与之相关的订单号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C%E6%AF%8F%E4%B8%80%E9%A1%B9%E4%BA%A7%E5%93%81%E7%9A%84%E6%80%BB%E8%AE%A2%E5%8D%95%E6%95%B0"><span class="nav-number">12.4.</span> <span class="nav-text">返回产品名称和每一项产品的总订单数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E4%BE%9B%E5%BA%94%E5%95%86%E5%8F%8A%E5%85%B6%E5%8F%AF%E4%BE%9B%E4%BA%A7%E5%93%81%E7%9A%84%E6%95%B0%E9%87%8F"><span class="nav-number">12.5.</span> <span class="nav-text">列出供应商及其可供产品的数量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">13.</span> <span class="nav-text">组合查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E4%B8%A4%E4%B8%AA-select-%E8%AF%AD%E5%8F%A5%E7%BB%93%E5%90%88%E8%B5%B7%E6%9D%A5%E4%B8%80"><span class="nav-number">13.1.</span> <span class="nav-text">将两个 SELECT
语句结合起来（一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E4%B8%A4%E4%B8%AA-select-%E8%AF%AD%E5%8F%A5%E7%BB%93%E5%90%88%E8%B5%B7%E6%9D%A5%E4%BA%8C"><span class="nav-number">13.2.</span> <span class="nav-text">将两个 SELECT
语句结合起来（二）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88-products-%E8%A1%A8%E4%B8%AD%E7%9A%84%E4%BA%A7%E5%93%81%E5%90%8D%E7%A7%B0%E5%92%8C-customers-%E8%A1%A8%E4%B8%AD%E7%9A%84%E9%A1%BE%E5%AE%A2%E5%90%8D%E7%A7%B0"><span class="nav-number">13.3.</span> <span class="nav-text">组合
Products 表中的产品名称和 Customers 表中的顾客名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-sql-%E8%AF%AD%E5%8F%A5-3"><span class="nav-number">13.4.</span> <span class="nav-text">检查 SQL 语句</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="刘易"
      src="https://raw.githubusercontent.com/lwmfjc/lwmfjc.github.io.resource/main/img/avatar.png">
  <p class="site-author-name" itemprop="name">刘易</p>
  <div class="site-description" itemprop="description">知命不惧 日日自新</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">188</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/lwmfjc" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lwmfjc" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘易</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.3m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">40:26</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
